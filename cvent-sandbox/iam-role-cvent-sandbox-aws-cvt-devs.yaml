AWSTemplateFormatVersion: 2010-09-09
Description: Description
Parameters:
  AccountName:
    Description: Name of the account this template is being deployed too
    Type: String
Resources:
  AwsCvtDevsRole:
    Properties:
      AssumeRolePolicyDocument:
        Statement:
        - Action: sts:AssumeRoleWithSAML
          Condition:
            StringEquals:
              SAML:aud: https://signin.aws.amazon.com/saml
          Effect: Allow
          Principal:
            Federated: arn:aws:iam::572724207364:saml-provider/okta-idp
        - Action: sts:AssumeRole
          Condition: {}
          Effect: Allow
          Principal:
            AWS: arn:aws:iam::667621734181:root
        Version: '2012-10-17'
      ManagedPolicyArns:
      - arn:aws:iam::aws:policy/AmazonSQSFullAccess
      - arn:aws:iam::aws:policy/AmazonForecastFullAccess
      - arn:aws:iam::572724207364:policy/cvent-deny-vpc-changes
      - arn:aws:iam::aws:policy/IAMReadOnlyAccess
      - arn:aws:iam::572724207364:policy/aws-cvt-devs-iamroles-policy
      - arn:aws:iam::572724207364:policy/iam-pass-policy
      - arn:aws:iam::aws:policy/PowerUserAccess
      MaxSessionDuration: 3600
      Path: /
      RoleName: aws-cvt-devs
    Type: AWS::IAM::Role

    CventNocPolicy:
      Type: AWS::IAM::Policy
      Properties:
        PolicyName: cvent-noc-policy
        PolicyDocument:
          Version: '2012-10-17'
          Statement:
          - Action:
              - s3:ListBucket
            Effect: Allow
            Resource:
            - arn:aws:s3:::cvent-sandbox-datawarehouse-datadev
          - Action:
              - s3:GetObject
              - s3:PutObject
              - s3:DeleteObject
            Effect: Allow
            Resource:
              - arn:aws:s3:::cvent-sandbox-datawarehouse-datadev*
          - Action:
              - logs:CreateLogStream
              - logs:DescribeLogStreams
              - logs:PutLogEvents
              - logs:CreateLogGroup
            Effect: Allow
            Resource:
              - arn:aws:logs:us-east-1:572724207364:log-group:/aws/sagemaker/*
              - arn:aws:logs:us-east-1:572724207364:log-group:/aws/sagemaker/*:log-stream:aws-glue-*
          - Action:
              - glue:UpdateDevEndpoint
              - glue:GetDevEndpoint
              - glue:GetDevEndpoints
            Effect: Allow
            Resource:
              - arn:aws:glue:us-east-1:572724207364:devEndpoint/datadev-devep-01*
          - Action: comprehend:*
            Effect: Allow
            Resource: "*"
        Roles:
            - Ref: AwsCvtDevsRole
