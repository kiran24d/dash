---
AWSTemplateFormatVersion: '2010-09-09'
Description: CloudAware IAM Role Stack Template

Metadata:
  AWS::CloudFormation::Interface:
    ParameterGroups:
      - Label:
          default: Access
        Parameters:
          - AccessRoleArn
          - AccessRoleName
          - AccessExternalId
      - Label:
          default: Policies
        Parameters:
          - PolicyCloudTrailStatus
          - PolicyBillingStatus
          - PolicyCloudAwareMonitoringStatus
          - PolicyBackupsStatus
          - PolicyTaggingStatus
          - PolicyEnterpriseLogManagementStatus
    ParameterLabels:
      AccessRoleArn:
        default: CloudAware Role ARN
      AccessRoleName:
        default: CloudAware Role Name
      AccessExternalId:
        default: External ID
      PolicyCloudTrailStatus:
        default: CloudTrail
      PolicyBillingStatus:
        default: Billing
      PolicyCloudAwareMonitoringStatus:
        default: CloudAware Monitoring
      PolicyBackupsStatus:
        default: Backups
      PolicyTaggingStatus:
        default: Tagging
      PolicyEnterpriseLogManagementStatus:
        default: Enterprise Log Management

Parameters:

  AccountName:
    Type: String
    Description: The name of the account that this template has been deployed too.

  AccessRoleArn:
    Type: String
    Default: CloudAware.aws
    MinLength: '1'
    AllowedValues:
      - CloudAware.aws
      - CloudAware.aws-us-gov
    Description: CloudAware trusted role ARN
  AccessRoleName:
    Type: String
    Default: auto-generate
    Description: Role name inside this account
  AccessExternalId:
    Type: String
    Default: a8fe837b-fce1-4aef-99bc-3bc0540ffe12
  PolicyCloudTrailStatus:
    Type: String
    Default: Not Available
    MinLength: '1'
    AllowedValues:
      - Not Available
  PolicyBillingStatus:
    Type: String
    Default: Not Available
    MinLength: '1'
    AllowedValues:
      - Not Available
  PolicyCloudAwareMonitoringStatus:
    Type: String
    Default: Disabled
    MinLength: '1'
    AllowedValues:
      - Enabled
      - Disabled
  PolicyBackupsStatus:
    Type: String
    Default: Disabled
    MinLength: '1'
    AllowedValues:
      - Enabled
      - Disabled
  PolicyTaggingStatus:
    Type: String
    Default: Disabled
    MinLength: '1'
    AllowedValues:
      - Enabled
      - Disabled
  PolicyEnterpriseLogManagementStatus:
    Type: String
    Default: Disabled
    MinLength: '1'
    AllowedValues:
      - Enabled
      - Disabled

Conditions:
  PolicyCloudTrailEnabled:
    Fn::Equals:
      - Ref: PolicyCloudTrailStatus
      - Enabled
  PolicyBillingEnabled:
    Fn::Equals:
      - Ref: PolicyBillingStatus
      - Enabled
  PolicyCloudAwareMonitoringEnabled:
    Fn::Equals:
      - Ref: PolicyCloudAwareMonitoringStatus
      - Enabled
  PolicyBackupsEnabled:
    Fn::Equals:
      - Ref: PolicyBackupsStatus
      - Enabled
  PolicyTaggingEnabled:
    Fn::Equals:
      - Ref: PolicyTaggingStatus
      - Enabled
  PolicyEnterpriseLogManagementEnabled:
    Fn::Equals:
      - Ref: PolicyEnterpriseLogManagementStatus
      - Enabled

Mappings:
  AccessRoleArnMap:
    CloudAware.aws:
      Arn: arn:aws:iam::814021343637:user/ca-collector
    CloudAware.aws-us-gov:
      Arn: arn:aws-us-gov:iam::321683528484:user/cloudaware-collector

Resources:
  CloudAwareIamRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName:
        Fn::Join:
          - "-"
          - - !Ref AccountName
            - cloud-aware
      AssumeRolePolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Principal:
              AWS:
                Fn::FindInMap:
                  - AccessRoleArnMap
                  - Ref: AccessRoleArn
                  - Arn
            Condition:
              StringEquals:
                sts:ExternalId:
                  Ref: AccessExternalId
            Action: sts:AssumeRole
  CollectorPolicy1:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      ManagedPolicyName: CloudAwareCollectorPolicy1
      Roles:
        - Ref: CloudAwareIamRole
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - ec2:Des*
              - ec2:G*
              - rds:Des*
              - rds:ListTagsForResource
              - iam:GenerateCredentialReport
              - iam:Get*
              - iam:L*
              - s3:GetA*
              - s3:GetB*
              - s3:GetEncryptionConfiguration
              - s3:GetI*
              - s3:GetLifecycleConfiguration
              - s3:GetMetricsConfiguration
              - s3:GetObjectAcl
              - s3:GetObjectTagging
              - s3:GetObjectV*
              - s3:GetReplicationConfiguration
              - s3:HeadBucket
              - s3:L*
              - sqs:G*
              - sqs:L*
              - cloudfront:G*
              - cloudfront:L*
              - elasticmapreduce:Des*
              - elasticmapreduce:L*
              - elasticmapreduce:ViewEventsFromAllClustersInConsole
              - elasticloadbalancing:Des*
              - snowball:D*
              - snowball:GetJobManifest
              - snowball:GetSnowballUsage
              - snowball:L*
              - cloudformation:Des*
              - cloudformation:G*
              - cloudformation:L*
              - route53:G*
              - route53:L*
              - elasticbeanstalk:Des*
              - elasticbeanstalk:L*
              - cloudwatch:Des*
              - cloudwatch:G*
              - cloudwatch:L*
              - autoscaling:Des*
              - ses:Des*
              - ses:G*
              - ses:L*
              - sts:G*
              - dynamodb:Des*
              - dynamodb:G*
              - dynamodb:L*
              - glacier:Des*
              - glacier:G*
              - glacier:L*
              - redshift:Des*
              - redshift:GetClusterCredentials
              - redshift:ViewQueriesInConsole
              - cloudtrail:DescribeTrails
              - cloudtrail:G*
              - cloudtrail:L*
              - kinesis:Des*
              - kinesis:G*
              - kinesis:L*
              - kinesisanalytics:DescribeApplication
              - kinesisanalytics:ListApplications
              - kinesisvideo:DescribeStream
              - kinesisvideo:G*
              - kinesisvideo:L*
              - ecs:Des*
              - ecs:L*
              - lambda:G*
              - lambda:L*
              - machinelearning:Des*
              - machinelearning:G*
              - kms:DescribeKey
              - kms:Get*
              - kms:L*
              - elasticache:Des*
              - elasticache:L*
              - iot:Des*
              - iot:G*
              - iot:L*
              - storagegateway:Des*
              - storagegateway:L*
              - workspaces:Des*
              - support:*
              - opsworks:Des*
              - opsworks:GetHostnameSuggestion
              - opsworks:ListTags
              - glue:BatchGetPartition
              - glue:G*
              - application-autoscaling:Des*
              - apigateway:GET
              - apigateway:HEAD
              - clouddirectory:G*
              - clouddirectory:L*
              - pricing:*
              - organizations:Des*
              - organizations:Li*
              - elasticfilesystem:Des*
              - ecr:BatchGetImage
              - ecr:Des*
              - ecr:G*
              - ecr:L*
              - comprehend:Des*
              - comprehend:L*
              - mobileanalytics:G*
              - crowd:GetTask
              - dms:Des*
              - dms:ListTagsForResource
              - ssm:Des*
              - ssm:G*
              - ssm:L*
              - sso:Des*
              - sso:G*
              - sso:Li*
              - mgh:Des*
              - mgh:L*
              - artifact:Get
              - transcribe:GetTranscriptionJob
              - transcribe:ListTranscriptionJobs
              - devicefarm:G*
              - devicefarm:L*
              - guardduty:G*
              - guardduty:L*
              - events:Des*
              - events:L*
              - lex:G*
              - ram:G*
              - ram:L*
              - signer:DescribeSigningJob
              - signer:G*
              - signer:L*
              - mediaconnect:DescribeFlow
              - mediaconnect:L*
              - sagemaker:Des*
              - sagemaker:GetSearchSuggestions
              - sagemaker:L*
              - mobilehub:DescribeBundle
              - mobilehub:Get*
              - mobilehub:L*
              - resource-groups:G*
              - resource-groups:L*
              - globalaccelerator:Des*
              - globalaccelerator:L*
              - serverlessrepo:G*
              - serverlessrepo:L*
              - sdb:GetAttributes
              - sdb:ListDomains
              - mediapackage:Des*
              - mediapackage:L*
              - kafka:DescribeCluster
              - kafka:GetBootstrapBrokers
              - kafka:L*
              - sms-voice:GetConfigurationSetEventDestinations
              - athena:B*
              - athena:G*
              - athena:L*
              - aws-marketplace:De*
              - aws-marketplace:L*
              - aws-marketplace:ViewSubscriptions
              - mobiletargeting:G*
              - sumerian:ViewRelease
              - autoscaling-plans:Des*
              - autoscaling-plans:GetScalingPlanResourceForecastData
              - cur:DescribeReportDefinitions
              - shield:Des*
              - shield:GetSubscriptionState
              - shield:L*
              - secretsmanager:DescribeSecret
              - secretsmanager:G*
              - secretsmanager:L*
              - route53domains:G*
              - route53domains:L*
              - route53domains:ViewBilling
              - fsx:Des*
              - fsx:ListTagsForResource
              - amplify:G*
              - amplify:L*
              - freertos:Des*
              - freertos:G*
              - freertos:L*
              - medialive:Des*
              - medialive:L*
              - cloudhsm:Des*
              - cloudhsm:GetConfig
              - cloudhsm:L*
              - codedeploy:B*
              - codedeploy:G*
              - codedeploy:L*
              - route53resolver:G*
              - route53resolver:L*
              - importexport:G*
              - importexport:ListJobs
              - workmail:Des*
              - workmail:G*
              - workmail:ListMembersInMailGroup
              - datapipeline:Des*
              - datapipeline:G*
              - datapipeline:ListPipelines
              - sms:Get*
              - sms:ListApps
              - codebuild:BatchG*
              - codebuild:L*
              - iotanalytics:Des*
              - iotanalytics:GetDatasetContent
              - iotanalytics:L*
              - connect:DescribeInstance
              - connect:G*
              - connect:ListInstances
              - ce:*
              - health:*
              - gamelift:Des*
              - gamelift:G*
              - gamelift:L*
              - deeplens:B*
              - deeplens:G*
              - deeplens:L*
              - opsworks-cm:Des*
              - sso-directory:Des*
              - sso-directory:GetDirectoryInfo
              - sso-directory:L*
              - discovery:Des*
              - discovery:GetDiscoverySummary
              - discovery:L*
              - codecommit:B*
              - codecommit:DescribePullRequestEvents
              - codecommit:Ge*
              - codecommit:L*
              - trustedadvisor:D*
              - cognito-idp:Des*
              - cognito-idp:Ge*
              - cognito-idp:L*
              - config:B*
              - config:Des*
              - config:G*
              - config:L*
              - swf:Des*
              - swf:GetWorkflowExecutionHistory
              - swf:L*
              - macie:L*
              - appsync:Ge*
              - appsync:L*
              - acm:DescribeCertificate
              - acm:GetCertificate
              - acm:L*
            Resource:
              - "*"
  CollectorPolicy2:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      ManagedPolicyName: CloudAwareCollectorPolicy2
      Roles:
        - Ref: CloudAwareIamRole
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - xray:BatchGetTraces
              - xray:G*
              - eks:Des*
              - eks:L*
              - fms:G*
              - fms:L*
              - translate:GetTerminology
              - translate:ListTerminologies
              - aws-portal:V*
              - ds:Des*
              - ds:G*
              - ds:L*
              - waf-regional:GetByteMatchSet
              - waf-regional:GetChangeTokenStatus
              - waf-regional:GetGeoMatchSet
              - waf-regional:GetIPSet
              - waf-regional:GetPermissionPolicy
              - waf-regional:GetR*
              - waf-regional:GetS*
              - waf-regional:GetW*
              - waf-regional:GetXssMatchSet
              - waf-regional:L*
              - dax:Des*
              - dax:GetItem
              - dax:L*
              - tag:G*
              - logs:Des*
              - logs:G*
              - logs:L*
              - chime:G*
              - chime:Li*
              - firehose:DescribeDeliveryStream
              - firehose:L*
              - servicecatalog:Des*
              - servicecatalog:L*
              - servicecatalog:SearchProd*
              - mechanicalturk:Ge*
              - mq:Des*
              - mq:L*
              - batch:Des*
              - batch:ListJobs
              - iotevents:Des*
              - iotevents:L*
              - es:Des*
              - es:G*
              - es:L*
              - cloud9:Des*
              - cloud9:GetUserPublicKey
              - cloud9:ListEnvironments
              - transfer:Des*
              - transfer:L*
              - budgets:ViewBudget
              - textract:G*
              - groundtruthlabeling:DescribeConsoleJob
              - groundtruthlabeling:ListDatasetObjects
              - cognito-identity:Des*
              - cognito-identity:G*
              - cognito-identity:L*
              - mediastore:Des*
              - mediastore:G*
              - mediastore:L*
              - polly:DescribeVoices
              - polly:G*
              - polly:L*
              - license-manager:G*
              - license-manager:L*
              - a4b:G*
              - a4b:L*
              - acm-pca:Des*
              - acm-pca:G*
              - acm-pca:L*
              - iot1click:Des*
              - iot1click:G*
              - iot1click:L*
              - states:Des*
              - states:G*
              - states:L*
              - codepipeline:G*
              - codepipeline:L*
              - securityhub:G*
              - securityhub:L*
              - ec2messages:G*
              - greengrass:G*
              - greengrass:L*
              - servicediscovery:G*
              - servicediscovery:L*
              - workdocs:Des*
              - workdocs:G*
              - aws-marketplace-management:v*
              - rekognition:DescribeStreamProcessor
              - rekognition:G*
              - rekognition:L*
              - waf:GetByteMatchSet
              - waf:GetChangeTokenStatus
              - waf:GetGeoMatchSet
              - waf:GetIPSet
              - waf:GetPermissionPolicy
              - waf:GetR*
              - waf:GetS*
              - waf:GetWebACL
              - waf:GetXssMatchSet
              - waf:L*
              - appstream:Des*
              - appstream:L*
              - quicksight:Des*
              - quicksight:GetGroupMapping
              - quicksight:L*
              - dlm:G*
              - wellarchitected:GetWorkload
              - wellarchitected:ListWorkloads
              - mediaconvert:Des*
              - mediaconvert:G*
              - mediaconvert:L*
              - inspector:Des*
              - inspector:GetTelemetryMetadata
              - inspector:L*
              - lightsail:G*
              - robomaker:Des*
              - robomaker:L*
              - codestar:Des*
              - codestar:GetExtendedAccess
              - codestar:L*
              - cognito-sync:Des*
              - cognito-sync:G*
              - cognito-sync:L*
              - cloudsearch:Des*
              - cloudsearch:L*
              - directconnect:Des*
              - elastictranscoder:L*
              - elastictranscoder:R*
              - pi:*
              - activate:GetMemberInfo
              - backup:Des*
              - backup:G*
              - backup:L*
              - worklink:Des*
              - worklink:L*
              - datasync:Des*
              - datasync:L*
            Resource:
              - "*"
  CloudTrailPolicy:
    Type: AWS::IAM::Policy
    Condition: PolicyCloudTrailEnabled
    Properties:
      PolicyName: CloudTrailPolicy
      Roles:
        - Ref: CloudAwareIamRole
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - cloudtrail:DescribeTrails
              - cloudtrail:GetTrailStatus
              - cloudtrail:LookupEvents
              - kms:ListAliases
              - s3:GetBucketLocation
              - s3:ListAllMyBuckets
            Resource:
              - "*"
          - Effect: Allow
            Action:
              - s3:ListBucket
            Resource:
              - arn:aws:s3:::YOUR-CLOUDTRAIL-BUCKET
          - Effect: Allow
            Action:
              - s3:GetObject
            Resource:
              - arn:aws:s3:::YOUR-CLOUDTRAIL-BUCKET/LOG-PREFIX/*
  BillingPolicy:
    Type: AWS::IAM::Policy
    Condition: PolicyBillingEnabled
    Properties:
      PolicyName: BillingPolicy
      Roles:
        - Ref: CloudAwareIamRole
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - s3:GetBucketLocation
              - s3:ListAllMyBuckets
            Resource:
              - arn:aws:s3:::*
          - Effect: Allow
            Action:
              - s3:ListBucket
            Resource:
              - arn:aws:s3:::YOUR-BILLING-BUCKET
          - Effect: Allow
            Action:
              - s3:GetObject
            Resource:
              - arn:aws:s3:::YOUR-BILLING-BUCKET/*
  CloudAwareMonitoringPolicy:
    Type: AWS::IAM::Policy
    Condition: PolicyCloudAwareMonitoringEnabled
    Properties:
      PolicyName: CloudAwareMonitoringPolicy
      Roles:
        - Ref: CloudAwareIamRole
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Sid: CaMonitoring
            Effect: Allow
            Action:
              - ec2:DescribeInstances
              - cloudwatch:List*
              - cloudwatch:Get*
            Resource:
              - "*"
  BackupsPolicy:
    Type: AWS::IAM::Policy
    Condition: PolicyBackupsEnabled
    Properties:
      PolicyName: BackupsPolicy
      Roles:
        - Ref: CloudAwareIamRole
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Sid: Ec2Backup
            Effect: Allow
            Action:
              - ec2:DescribeInstances
              - ec2:DescribeImages
              - ec2:CreateImage
              - ec2:DeregisterImage
              - ec2:DescribeSnapshots
              - ec2:DeleteSnapshot
              - ec2:CreateTags
              - ec2:DeleteTags
            Resource:
              - "*"
          - Sid: RdsBackup
            Effect: Allow
            Action:
              - rds:DescribeDBInstances
              - rds:DescribeDBSnapshots
              - rds:CreateDBSnapshot
              - rds:DeleteDBSnapshot
              - rds:ListTagsForResource
              - rds:AddTagsToResource
              - rds:RemoveTagsFromResource
            Resource:
              - "*"
          - Sid: S3Backup
            Effect: Allow
            Action:
              - s3:ListAllMyBuckets
              - s3:ListBucket
              - s3:GetBucketLocation
              - s3:PutObject
              - s3:DeleteObject
              - s3:GetBucketTagging
              - s3:PutBucketTagging
            Resource:
              - "*"
  TaggingPolicy:
    Type: AWS::IAM::Policy
    Condition: PolicyTaggingEnabled
    Properties:
      PolicyName: TaggingPolicy
      Roles:
        - Ref: CloudAwareIamRole
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - a4b:ListTags
              - a4b:TagResource
              - acm-pca:ListTags
              - acm-pca:TagCertificateAuthority
              - acm:AddTagsToCertificate
              - acm:ListTagsForCertificate
              - acm:RemoveTagsFromCertificate
              - appstream:ListTagsForResource
              - appstream:TagResource
              - autoscaling:CreateOrUpdateTags
              - autoscaling:DeleteTags
              - autoscaling:DescribeTags
              - ce:GetTags
              - clouddirectory:ListTagsForResource
              - clouddirectory:TagResource
              - cloudfront:ListTagsForResource
              - cloudfront:TagResource
              - cloudhsm:AddTagsToResource
              - cloudhsm:ListTags*
              - cloudhsm:RemoveTagsFromResource
              - cloudhsm:TagResource
              - cloudsearch:AddTags
              - cloudsearch:ListTags
              - cloudsearch:RemoveTags
              - cloudtrail:AddTags
              - cloudtrail:ListTags
              - cloudtrail:RemoveTags
              - codedeploy:AddTagsToOnPremisesInstances
              - codedeploy:RemoveTagsFromOnPremisesInstances
              - config:GetTagKeys
              - datapipeline:AddTags
              - datapipeline:RemoveTags
              - dax:ListTags
              - dax:TagResource
              - discovery:CreateTags
              - discovery:DeleteTags
              - discovery:DescribeTags
              - dms:AddTagsToResource
              - dms:ListTagsForResource
              - dms:RemoveTagsFromResource
              - ds:AddTagsToResource
              - ds:ListTagsForResource
              - ds:RemoveTagsFromResource
              - dynamodb:ListTagsOfResource
              - dynamodb:TagResource
              - ec2:CreateTags
              - ec2:DeleteTags
              - ec2:DescribeTags
              - elasticache:AddTagsToResource
              - elasticache:ListTagsForResource
              - elasticache:RemoveTagsFromResource
              - elasticfilesystem:CreateTags
              - elasticfilesystem:DeleteTags
              - elasticfilesystem:DescribeTags
              - elasticloadbalancing:AddTags
              - elasticloadbalancing:DescribeTags
              - elasticloadbalancing:RemoveTags
              - elasticmapreduce:AddTags
              - elasticmapreduce:RemoveTags
              - es:AddTags
              - es:ListTags
              - es:RemoveTags
              - fsx:ListTagsForResource
              - fsx:TagResource
              - glacier:AddTagsToVault
              - glacier:ListTagsForVault
              - glacier:RemoveTagsFromVault
              - iam:ListRoleTags
              - iam:ListUserTags
              - iam:Tag*
              - inspector:ListTagsForResource
              - inspector:SetTagsForResource
              - iot:ListTagsForResource
              - iot:TagResource
              - iotanalytics:ListTagsForResource
              - iotanalytics:TagResource
              - kinesis:AddTagsToStream
              - kinesis:ListTagsForStream
              - kinesis:RemoveTagsFromStream
              - kinesisvideo:ListTagsForStream
              - kinesisvideo:TagStream
              - kms:ListResourceTags
              - kms:TagResource
              - lambda:ListTags
              - lambda:TagResource
              - license-manager:ListTagsForResource
              - license-manager:TagResource
              - logs:ListTagsLogGroup
              - logs:TagLogGroup
              - machinelearning:AddTags
              - machinelearning:DeleteTags
              - machinelearning:DescribeTags
              - mq:CreateTags
              - mq:DeleteTags
              - mq:ListTags
              - opsworks:ListTags
              - opsworks:TagResource
              - ram:TagResource
              - rds:AddTagsToResource
              - rds:ListTagsForResource
              - rds:RemoveTagsFromResource
              - redshift:CreateTags
              - redshift:DeleteTags
              - redshift:DescribeTags
              - resource-groups:GetTags
              - resource-groups:Tag
              - route53:ChangeTagsForResource
              - route53:ListTags*
              - route53domains:DeleteTagsForDomain
              - route53domains:ListTagsForDomain
              - route53domains:UpdateTagsForDomain
              - route53resolver:ListTagsForResource
              - route53resolver:TagResource
              - s3:DeleteObjectTagging
              - s3:DeleteObjectVersionTagging
              - s3:GetBucketTagging
              - s3:GetObjectTagging
              - s3:GetObjectVersionTagging
              - s3:ListBucketByTags
              - s3:PutBucketTagging
              - s3:PutObjectTagging
              - s3:PutObjectVersionTagging
              - s3:ReplicateTags
              - sagemaker:AddTags
              - sagemaker:DeleteTags
              - sagemaker:ListTags
              - secretsmanager:TagResource
              - sqs:ListQueueTags
              - sqs:TagQueue
              - ssm:AddTagsToResource
              - ssm:ListTagsForResource
              - ssm:RemoveTagsFromResource
              - storagegateway:AddTagsToResource
              - storagegateway:ListTagsForResource
              - storagegateway:RemoveTagsFromResource
              - tag:GetTag*
              - tag:TagResources
              - transfer:ListTagsForResource
              - transfer:TagResource
              - workspaces:CreateTags
              - workspaces:DeleteTags
              - workspaces:DescribeTags
            Resource:
              - "*"
  EnterpriseLogManagementPolicy:
    Type: AWS::IAM::Policy
    Condition: PolicyEnterpriseLogManagementEnabled
    Properties:
      PolicyName: EnterpriseLogManagementPolicy
      Roles:
        - Ref: CloudAwareIamRole
      PolicyDocument:
        Version: '2012-10-17'
        Statement:
          - Effect: Allow
            Action:
              - autoscaling:Describe*
              - budgets:ViewBudget
              - cloudtrail:DescribeTrails
              - cloudtrail:GetTrailStatus
              - elasticbeanstalk:describe*
              - cloudwatch:Describe*
              - cloudwatch:Get*
              - cloudwatch:List*
              - dynamodb:list*
              - dynamodb:describe*
              - ec2:Describe*
              - ec2:Get*
              - ecs:Describe*
              - ecs:List*
              - elasticache:Describe*
              - elasticache:List*
              - elasticloadbalancing:Describe*
              - elasticmapreduce:List*
              - elasticmapreduce:Describe*
              - elb:describe*
              - elbv2:describe*
              - elasticloadbalancing:describe*
              - es:ListTags
              - es:ListDomainNames
              - es:DescribeElasticsearchDomains
              - kinesis:List*
              - kinesis:Describe*
              - logs:*
              - rds:Describe*
              - rds:List*
              - route53:List*
              - iam:GetUser
              - s3:Get*
              - s3:List*
              - ses:Get*
              - sns:List*
              - sns:Publish
              - sqs:ListQueues
              - support:*
            Resource:
              - "*"
Outputs:
  IamRoleArn:
    Value:
      Fn::GetAtt:
        - CloudAwareIamRole
        - Arn
